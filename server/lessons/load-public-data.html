<header>
  <h1>Load public data and make a column chart</h1>
  <p>Manipulate open data with Workbench.</p>
</header>
<section>
  <h2>Overview</h2>
  <p>In this lesson you will analyse open data from the City of San Francisco.</p>
  <p>You will visualize how many housing projects with more  than 20 affordable units are planned to be built in the sunny Mission district.</p>
</section>
<section>
  <h2>1. Load Public Data by URL</h2>
  <p>Through this lesson you will work with the dataset ‘Affordable Housing Pipeline’, publicaly hosted on Workbench. </p>
  <ol class="steps">
    <li
      data-highlight='[{"type":"ModuleSearch"},{"type":"MlModule","name":"Add from URL"}]'
      data-test="return workflow.wfModules.length === 1 && workflow.wfModules[0].moduleName === 'Add from URL'"
      >Add the module ‘Add from URL’.</li>
    <li
      data-highlight='[{"type":"WfParameter","moduleName":"Add from URL","name":"url"}]'
      data-test="return workflow.wfModules.length > 0 && workflow.wfModules[0].parameters.get('url') === 'https://data.sfgov.org/resource/e2px-wugd.json'"
      >Paste in the URL of the dataset in the module.
      <div class="copy-txt content-3 t-white">https://data.sfgov.org/resource/e2px-wugd.json</div>
    </li>
    <li
      data-highlight='[{"type":"WfModuleContextButton","moduleName":"Add from URL","button":"notes"},{"type":"EditableNotes"}]',
      data-test="return workflow.wfModules.length > 0 && workflow.wfModules[0].note.length > 0"
      >Add a note to the module, for example:
      <div class="copy-txt content-3 t-white">Hello, world!</div>
    </li>
    <li
      data-highlight='[]'
      data-test="return workflow.wfModules.length > 0 && workflow.wfModules[0].isCollapsed"
      >Collapse the module.</li>
  </ol>
</section>
<section>
  <h2>2. Making a column Chart</h2>
  <p>Let’s add a column chart to visualize this data.</p>
  <ol class="steps">
    <li
      data-highlight='[{"type":"ModuleSearch"},{"type":"MlModule","name":"Column chart"}]'
      data-test="return workflow.wfModules.length > 1 && workflow.wfModules[workflow.wfModules.length-1].moduleName === 'Column chart'"
      >Add the module ‘Column chart’ using the search in the module library.</li>
    <li
      data-highlight='[]'
      data-test="return workflow.wfModules.length > 1 && workflow.wfModules[workflow.wfModules.length-1].parameters.get('title').length > 0"
      >Add a title to the chart.</li>
  </ol>
</section>
<section>
  <h2>3. Filtering with a condition</h2>
  <p>Let’s make our chart more legible by filtering and sorting its data.</p>
  <ol class="steps">
    <li
      data-highlight='[]'
      data-test="return workflow.wfModules.length > 2 && workflow.wfModules[1].moduleName === 'Filter'"
      >Add the module ‘Filter’ by dragging it between the two already there.</li>
    <li
      data-highlight='[]'
      data-test="const params = workflow.wfModules[1].moduleName.parameters; return params.get('column') === 'affordable_units' && params.get('condition') === 'Greater Than' && params.get('value') === '200' && params.get('keep') === 'Keep'"
      >Select the column ‘Affordable units’, choose the condition ‘Greater than’ and keep all rows having more than 200 affordable units.</li>
    <li
      data-highlight='[]'
      data-test="return state.selectedWfModule.moduleName === 'Column chart'"
      >Select the ‘Column chart’ module to see the chart with revised data.</li>
  </ol>
</section>
