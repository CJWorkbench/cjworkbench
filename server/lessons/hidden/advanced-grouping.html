<header>
  <h1>Grouping by dates, and multiple columns<h1>
</header>

<section class="fullscreen">
  <h2>Introduction</h2>
  <p>
    In the last lesson we learned how to ensure that a column of dates has the correct “Date” type.
    Now we’re ready to group by date, using the same police incident data from the City of New York we used in the previous lesson.
  </p>
  <p>
    We’ll answer the question: how many incidents were reported each month in each borough of the city?
  </p>
</section>

<!-- Section 1 -->

<script id="initialWorkflow" type="application/json">
  {
    "tabs": [
      {
        "name": "Lesson",
        "wfModules": [
          {
            "module":"loadurl",
            "params": {
              "url":"http://production-static.workbenchdata.com/data/intro-data-j/NYC-incidents-2018.csv"
            }
          },
          {
            "module":"selectcolumns",
            "params": {
              "colnames":"boro_nm,cmplnt_fr_dt"
            }
          },
          {
            "module":"renamecolumns",
            "params": {
              "rename-entries":"{\"boro_nm\":\"Borough\", \"cmplnt_fr_dt\":\"Complaint date\"}"
            }
          },
          {
            "module":"convert-date",
            "params": {
              "colnames":"Complaint date"
            }
          }
        ]
      },
      {
        "name": "Data dictionary",
        "wfModules": [
          {
            "module":"loadurl",
            "params": {
              "url":"http://production-static.workbenchdata.com/data/intro-data-j/NYPD_Complaint_YTD_DataDictionary.csv"
            }
          }
        ]
      }
    ]
  }
</script>
<section>
  <h2>Grouping by date</h2>
  <p>
    Our first question is ‘How many incidents were reported each month, in the entire city?’
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add <kbd>Group</kbd>, and select the column <kbd>Complaint date</kbd>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Check <kbd>Group dates</kbd> and select <kbd>by month</kbd> as granularity.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Name the output column <kbd>Count of incidents</kbd>.
    </li>
  </ol>
</section>
<section>
  <h2>Granularity</h2>
  <p>
    Let’s visualize this data in a line chart.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add a Line chart. Choose <kbd>Complaint date</kbd> as the X axis and plot <kbd>Count</kbd> on the Y-axis.
      <p class="instruction-detail">Charts with two data points are not very useful. To visualize the same data but for each day, we can change the granularity of the group.</p>
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >In the Group in step 5, change the granularity to <kbd>by day</kbd>.
      <p class="instruction-detail">
        Select step 6 to display your new chart.
      </p>
    </li>
    </li>
  </ol>
</section>
<section>
  <h2>Grouping by multiple columns</h2>
  <p>
    Now let’s break this data down further, by borough.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >In the Group step, add the <kbd>Borough</kbd> column next to <kbd>Complaint date</kbd> using the same column selector.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Switch back the granularity to <kbd>by month</kbd> for now.
      <p class="instruction-detail">
        By looking at this table we can rapidly see if different parts of town have different patterns of crime - or at least reported incidents. It’s important to remember that data only exists when someone types it in.
      </p>
    </li>
  </ol>
</section>
<footer>
  <h2>Lesson Complete!</h2>
  <div class="completed">
    <p class="summary"> After being grouped by more than one column the table cannot be visualized with one line per borough, because that would require the data for each borough to be displayed in its own column.
    </p>
    <p class="summary">
      Next lesson, we’ll learn how to change table formats from Long to Wide to be able to access any variable we need.
    </p>
  </div>
  <div class="next">
    <h2>Next</h2>
    <ol>
      <li>
        <a href="/lessons/long-and-wide-format">Long and wide format</a>
      </li>
    </ol>
  </div>
</footer>
