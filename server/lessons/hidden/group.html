<header>
  <h1>Summarizing data by grouping<h1>
</header>

<section class="fullscreen">
  <h2>Introduction</h2>
  <p>
    Grouping rows together is one of the most powerful ways of understanding data. This operation is sometimes called “pivot tables” or “group by”. Its purpose is to summarize large amounts of data quickly.
  <p>
    In this lesson we will continue working with San Francisco Housing data to analyze how many affordable units are planned to be built in each neighborhood of the city.
  </p>
</section>

<!-- Section 1 -->

<script id="initialWorkflow" type="application/json">
  {
    "tabs": [
      {
        "name": "Lesson",
        "wfModules": [
          {
            "module":"loadurl",
            "params": {
              "url":"http://production-static.workbenchdata.com/data/intro-data-j/affordable-housing-pipeline.csv"
            }
          },
          {
            "module":"selectcolumns",
            "params": {
              "colnames":"Project Status,Planning Neighborhood,Project Units,Affordable Units,% Affordable"
            }
          },
          {
            "module":"filter",
            "params": {
              "filters": {
                "filters": [
                  {
                    "operator": "and",
                    "subfilters": [
                      {
                        "value": "50",
                        "colname": "% Affordable",
                        "condition": "number_is_greater_than",
                        "case_sensitive": false
                      },
                      {
                        "value": "100",
                        "colname": "Project Units",
                        "condition": "number_is_greater_than",
                        "case_sensitive": false
                      }
                    ]
                  }
                ],
                "operator": "and"
              }
            }
          }
        ]
      },
      {
        "name": "Data dictionary",
        "wfModules": [
          {
            "module":"loadurl",
            "params": {
              "url":"http://production-static.workbenchdata.com/data/intro-data-j/dataDictionary-affordable-housing-pipeline.csv"
            }
          }
        ]
      }
    ]
  }
</script>

<section>
  <h2>Grouping and counting</h2>
  <p>In the previous lesson, we filtered <a class="highlight" href='https://data.sfgov.org/Housing-and-Buildings/Affordable-Housing-Pipeline/aaxw-2cb8' target="_blank" className="info-1">San Francisco Housing data</a> to reveal sizable new constructions containing a majority of affordable units. </p>
  </p>
    Let’s take it from there and find out how many of these projects are in each neighborhood.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add 'Group' in position 4 and select the column <kbd>Planning neighborhood</kbd>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Keep the first operation set to <kbd>count</kbd>. It will count all rows within each group.
      <p class ="instruction-detail">
        Since each row is one project and rows are grouped by neighborhood, the output table is a count of projects per neighborhood.
      </p>
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Name the new  column to <kbd>Number of projects</kbd>.
    </li>
  </ol>
</section>
<section>
  <h2>Operations within groups</h2>
  <p>
    Just counting projects gives us little information about the number of new housing units.
  </p>
  <p>
    Instead let’s sum the number of affordable units that are planned to be built in each neighborhood.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >In the existing Group step, add another operation below <kbd>Count</kbd>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >As a new operation, select <kbd>Sum</kbd> and choose the column <kbd>affordable units</kbd> as the target.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Name the new column <kbd>Sum of affordable units</kbd>
      <p class="instruction-detail">
        In addition to counting projects per neighborhood, we are now calculating the sum of all <kbd>Affordable Units</kbd> within each neighborhood group. Let's visualize this data.
      </p>
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add a Column chart step. Select the variable <kbd>Planning Neighborhood</kbd>as the X axis and<kbd>Sum of affordable units</kbd>on the Y axis.
      <p class="instruction-detail">Now let’s compare China’s production of CO2 to that of other countries.</p>
    </li>
  </ol>
</section
<section>
<footer>
  <h2>Lesson Complete!</h2>
  <div class="completed">
    <p class="summary"> Next, go through more advanced data cleaning techniques and apply what we have learned so far to report on campaign finance data.</p>
  </div>
  <div class="next">
    <h2>Next</h2>
    <ol>
      <li>
        <a href="/lessons/cleaning-campaign-finance-data/">Story: Cleaning campaign finance data and analyzing the provenance of contributions</a>
      </li>
    </ol>
  </div>
</footer>
