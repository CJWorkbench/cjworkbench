<header>
  <h1>Story: Cleaning campaign finance data and analyzing out-of-state contributions<h1>
</header>

<section class="fullscreen">
  <h2>Introduction</h2>
  <p>
    Campaign finance is a classic topic in data journalism. Unfortunately, campaign finance data often requires a lot of cleaning before you can answer basic questions, such as “Who donated the most money?”
  </p>
  <p>
    In this lesson we will use data on contributions to a political campaign in the state of New York. We will extract the state from donor addresses, so that we can group donations by state. This requires splitting a column of text and removing unwanted information, which is a skill you will use many times.
  </p>
</section>

<script id="initialWorkflow" type="application/json">
  {
    "tabs": [
      {
        "name": "Lesson",
        "wfModules": [
          {
            "module":"loadurl",
            "params": {
              "url":"http://production-static.workbenchdata.com/data/intro-data-j/cuomo-contributions.csv"
            }
          }
        ]
      }
    ]
  }
</script>

<section>
  <h2>Data</h2>
  <p>
    Let's analyze campaign contributions to Andrew Cuomo’s 2014 re-election campaign in the State of New York.
    This data is published by the Board of Election of the State of New York,
  <a class="highlight" href='https://www.elections.ny.gov/CFViewReports.html#Query' target="_blank" className="info-1">here</a>.
  </p>
  <p>
    Our goal is to find which state donated the most to his campaign. Out of state campaign contributions could reveal previously hidden business or political connections.
  </p>
  <p>
    As usual, go through your list of questions and make sure you understand each column.
  </p>
  <p>
    Where can the donor’s state be found?
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >What does each row represent?
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >What's in each column?
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Are there any columns, values or codes you don't understand?
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Are there missing or obviously wrong values?
    </li>
    <li
      data-highlight='[]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Does the data need to be cleaned?
    </li>
  </ol>
</section>
<section>
  <h2>Splitting columns</h2>
  <p>
    Our first task is to extract the two letter state abbreviations in the <kbd>Contributor</kbd> column.
  </p>
  <p>
    We need to store the state by itself in a new column, so that we can apply Group to it, and get a breakdown of donations by state.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Select and keep the columns <kbd>Contributor</kbd> and <kbd>Amt</kbd>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add <kbd>Split column</kbd> and select the column <kbd>Contributor</kbd>.

    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Choose the method <kbd>Extract characters from right</kbd>.
      <p class="instruction-detail">
        The total number of characters used by the post code (5), the state abbreviation (2) and the space in between them (1) is <kbd>8</kbd>.
      </p>
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Set <kbd>Numbers of characters</kbd> to <kbd>8</kbd>.
    </li>
  </ol>
</section>
<section>
  <h2>Cleaning text</h2>
  <p>
    We now have the zip code plus the state in the column <kbd>Contributor 2</kbd>.
  </p>
  <p>
    There are different ways to remove the zip code, but the simplest here is to keep only letters.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add <kbd>Clean text</kbd>, and apply it to the <kbd>Contributor 2</kbd> column.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >In the 'Characters' section of Clean text, keep only letters. Deleting numbers would leave the space!
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Rename the columns <kbd>amt</kbd> and <kbd>Contributor 2</kbd> respectively to <kbd>Amount</kbd> and <kbd>State</kbd> by editing the column name in the table.
      <p class="instruction-detail">Now we have a clean “State” column. Our table is ready to be analyzed!</p>
    </li>
  </ol>
</section>
<section>
  <h2>Grouping</h2>
  <p>Next let's calculate the amount that has been donated in each state, using Group.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add the step <kbd>Group</kbd> and apply it to <kbd>State</kbd>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Set the operation to <kbd>SUM</kbd>, and choose the <kbd>Amount</kbd> column as the target.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Name the new column <kbd>Total amount</kbd>.
      <p class="instruction-detail">We can now see the total amount of contributions from donors in each state.</p>
    </li>
  </ol>
</section>
<section>
  <h2>Sort and chart</h2>
  <p>
    Let’s visualize these results. First, lets delete donations from New York since they are not the object of our investigation.
  </p>
  <h3 class="instructions">Instructions</h3>
  <ol class="steps">
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Select row 1 and choose <kbd>Delete selected rows</kbd> in the table header's action menu.
      <span>
        <img class="icon-insert" src="images/lesson-icons/menu.svg">
      </span>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Select <kbd>Sort descending</kbd> from the <kbd>Total amount</kbd> column menu
      <span>
        <img class="icon-insert" src="images/lesson-icons/menu.svg">
      </span>.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Add a Column Chart.
    </li>
    <li
      data-highlight='[{"type":"Module","index":0,"name":"Add from URL"}]'
      data-test="return workflow.tabs[0].wfModuleNames[0] === 'Add from URL'"
      >Set the X Axis to <kbd>State,</kbd> and the Y axis to <kbd>Total amount</kbd>.
      <p class="instruction-detail">

      </p>
    </li>
  </ol>
</section>
<footer>
  <h2>Lesson Complete!</h2>
  <div class="completed">
    <p>
       California is the first out-of-state contributor to Governor Cuomo's election's campaign. Who are these connections, and why are they interested in election in the state of New York?
    </p>
    <p>
      This may only be the beginning of your investigation.
    </p>
    <p>
      Next, we’ll learn about data types.
    </p>
  </div>
  <div class="next">
    <h2>Next</h2>
    <ol>
      <li>
        <a href="data-types">Introduction to data types.</a>
      </li>
    </ol>
  </div>
</footer>
