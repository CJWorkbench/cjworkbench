# -*- coding: utf-8 -*-
# Generated by Django 1.11 on 2018-09-28 19:06
from __future__ import unicode_literals

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('server', '0128_wfmodule_cached_render_result_quick_fixes'),
    ]

    operations = [
        migrations.AddField(
            model_name='wfmodule',
            name='cached_render_result_status',
            field=models.CharField(blank=True, choices=[('ok', 'ok'), ('error', 'error'), ('unreachable', 'unreachable')], max_length=20, null=True),
        ),
        migrations.RunSQL([
            # Pre-migration, Workbench _has_ no errors: it only has warnings.
            # Our ugly pattern is that modules tend to return their input as
            # output when they contain errors. Post-migration, such behavior
            # means "warning, not error".
            """
            UPDATE server_wfmodule
            SET cached_render_result_status = 'ok'
            WHERE cached_render_result_delta_id = last_relevant_delta_id
            """
        ], elidable=True)
    ]
