version: '3.4'
# These settings are specific to dev mode

services:
  upload-assets:
    image: 'gcr.io/workbenchdata-ci/upload-assets:integrationtest'

  migrate:
    image: 'gcr.io/workbenchdata-ci/migrate:integrationtest'

  fetcher:
    image: 'gcr.io/workbenchdata-ci/fetcher:integrationtest'

  renderer:
    image: 'gcr.io/workbenchdata-ci/renderer:integrationtest'

  cron:
    image: 'gcr.io/workbenchdata-ci/cron:integrationtest'

  cron-delta-deleter:
    image: 'gcr.io/workbenchdata-ci/cron:integrationtest'

  cron-expired-session-deleter:
    image: 'gcr.io/workbenchdata-ci/cron:integrationtest'

  cron-lesson-workflow-deleter:
    image: 'gcr.io/workbenchdata-ci/cron:integrationtest'

  frontend:
    image: 'gcr.io/workbenchdata-ci/frontend:integrationtest'

  tusd-hooks:
    image: 'gcr.io/workbenchdata-ci/tusd-hooks:integrationtest'

  integration-test:
    build:
      context: ..
      dockerfile: Dockerfile.integrationtest
      target: dev
    # Allow access using vncviewer
    ports: [ '5901:5901' ]
    volumes:
      # Allow editing code in dev mode
      - .:/app/integrationtests
